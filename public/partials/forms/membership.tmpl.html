<div ng-controller="MembershipCtrl" class="md-whiteframe-z1 small-form">
    <form name="userForm" novalidate>
        <md-tabs md-selected="data.index" md-dynamic-height>
                <md-tab label="Join">
                    <div layout="row" layout-sm="column" layout-align="center center">
                        <div>
                            <h2>Join the Centerville High School PTO!</h2>

                            <p>Joining helps support teachers, students, and parents:</p>
                            <ul>
                                <li>PTO Scholarships for Students</li>
                                <li>After-Prom</li>
                                <li>College Information Night</li>
                                <li>Various clubs and activities</li>
                                <li>ELK PRIDE</li>
                                <li>Teacher Recognition Luncheon</li>
                                <li>Academic Volunteer program</li>
                                <li>College and Career fair</li>
                                <li>Open House</li>
                                <li>College Financial Aid Information Night</li>
                                <li>ELK NEWS daily email service</li>
                            </ul>
                        </div>
                        <md-button class="md-raised md-primary" type="button" ng-click="data.accept()">Join</md-button>
                    </div>
                </md-tab>
                <md-tab label="You">
                    <ng-form name="youForm" layout-margin layout="column">
                        <div layout="row" layout-sm="column">
                            <md-input-container flex>
                                <label>First Name</label>
                                <input name="firstName" ng-model="user.first" type="text" required autocomplete>

                                <div ng-messages="youForm.firstName.$error" ng-if="youForm.$dirty">
                                    <div ng-message="required">Required</div>
                                </div>
                            </md-input-container>
                            <md-input-container flex>
                                <label>Last Name</label>
                                <input name="lastName" ng-model="user.last" type="text" required>

                                <div ng-messages="youForm.lastName.$error" ng-if="youForm.$dirty">
                                    <div ng-message="required">Required</div>
                                </div>
                            </md-input-container>
                        </div>
                        <div>
                            <md-input-container flex>
                                <label>Address</label>
                                <input name="address" ng-model="user.address" type="text" required>

                                <div ng-messages="youForm.address.$error" ng-if="youForm.$dirty">
                                    <div ng-message="required">Required</div>
                                </div>
                            </md-input-container>
                        </div>
                        <div layout="row" layout-sm="column">
                            <md-input-container flex>
                                <label>City</label>
                                <input name="city" ng-model="user.city" type="text" required>

                                <div ng-messages="youForm.city.$error" ng-if="youForm.$dirty">
                                    <div ng-message="required">Required</div>
                                </div>
                            </md-input-container>
                            <md-input-container flex>
                                <label>State</label>
                                <input name="state" ng-model="user.state" type="text" required>

                                <div ng-messages="youForm.state.$error" ng-if="youForm.$dirty">
                                    <div ng-message="required">Required</div>
                                </div>
                            </md-input-container>
                            <md-input-container flex>
                                <label>Zip Code</label>
                                <input name="zip" ng-model="user.postalCode" type="text" ng-pattern="/(\d{5}[-]\d{4})|(^\d{5}$)/"
                                       required>

                                <div ng-messages="youForm.zip.$error" ng-if="youForm.$dirty">
                                    <div ng-message="required">Required</div>
                                    <div ng-message="pattern">Valid zip code: 12345 or 12345-6789</div>
                                </div>
                            </md-input-container>
                        </div>

                    </ng-form>
                    <md-button type="button" ng-disabled="youForm.$invalid" class="form-next" ng-click="data.next()">Next</md-button>
                </md-tab>
                <md-tab label="Students">
                    <div layout-margin>
                        <div>
                            <label>Add a Student</label>
                            <md-slider md-discrete ng-model="numStudents"
                                       ng-change="changeStudents(numStudents)"
                                       step="1" min="1" max="7" aria-label="Student count"></md-slider>
                        </div>
                        <ng-form name="studentForm">
                            <div ng-repeat="student in user.students">
                                <ng-form name="innerForm">
                                    <h3 class="md-primary">Student {{$index+1}}</h3>

                                    <div layout layout-sm="column">
                                        <md-input-container flex>
                                            <label>First Name</label>
                                            <input name="first" ng-model="student.first" required>

                                            <div ng-messages="innerForm.first.$error" ng-if="innerForm.$dirty">
                                                <div ng-message="required">Required</div>
                                            </div>
                                        </md-input-container>
                                        <md-input-container flex>
                                            <label>Last Name</label>
                                            <input name="last" ng-model="student.last" required>

                                            <div ng-messages="innerForm.last.$error" ng-if="innerForm.$dirty">
                                                <div ng-message="required">Required</div>
                                            </div>
                                        </md-input-container>
                                    </div>
                                    <div layout layout-sm="column" layout-align="space-around center">
                                        <md-input-container>
                                            <md-select name="grade" placeholder="Grade" ng-model="student.grade" required>
                                                <md-option value="9">Freshmen</md-option>
                                                <md-option value="10">Sophomore</md-option>
                                                <md-option value="11">Junior</md-option>
                                                <md-option value="12">Senior</md-option>
                                            </md-select>
                                            <div ng-messages="innerForm.grade.$error" ng-if="innerForm.$dirty">
                                                <div ng-message="required">Required</div>
                                            </div>
                                        </md-input-container>
                                        <md-input-container>
                                            <md-select name="unit" placeholder="Unit" ng-model="student.unit" required>
                                                <md-option value="E">East</md-option>
                                                <md-option value="S">South</md-option>
                                                <md-option value="W">West</md-option>
                                            </md-select>
                                            <div ng-messages="innerForm.unit.$error" ng-if="innerForm.$dirty">
                                                <div ng-message="required">Required</div>
                                            </div>
                                        </md-input-container>

                                    </div>
                                </ng-form>
                            </div>
                        </ng-form>
                    </div>
                    <md-button type="button" ng-disabled="studentForm.$invalid" class="form-next" ng-click="data.next()">Next</md-button>
                </md-tab>
                <md-tab label="Donate">
                        <ng-form name="paymentForm" layout-margin layout="column" layout-align-gt-sm="space-around center">
                            <div>
                                <div layout="column" layout-align="center center">
                                    <h3 ng-model="payment.amount">{{ payment.amount | currency }}</h3>
                                </div>
                                <md-slider ng-model="payment.amount" min="0.00" max="500.00" aria-label="Payment amount"></md-slider>
                                <div layout="row">
                                    <md-input-container flex>
                                        <label for="cc-given-name">First</label>
                                        <input name="paymentFirst" id="cc-given-name" ng-model="payment.first"
                                               ng-required="payment.amount > 0">

                                        <div ng-messages="paymentForm.paymentFirst.$error">
                                            <div ng-message="required">Required</div>
                                        </div>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <label for="cc-family-name">Last</label>
                                        <input name="paymentLast" id="cc-family-name" ng-model="payment.last"
                                               ng-required="payment.amount > 0">

                                        <div ng-messages="paymentForm.paymentLast.$error">
                                            <div ng-message="required">Required</div>
                                        </div>
                                    </md-input-container>
                                </div>
                                <div layout="row">
                                    <md-input-container flex>
                                        <label for="cc-number">Number</label>
                                        <input name="cardnumber" id="cc-number" ng-model="payment.number"
                                               ng-required="payment.amount > 0" inputmode="numeric"
                                               ng-pattern="/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|6(?:011|5[0-9]{2})[0-9]{12}|(?:2131|1800|35\d{3})\d{11})$/">
                                        <!-- pattern from developers.google.com -->

                                        <div ng-messages="paymentForm.cardnumber.$error">
                                            <div ng-message="required">Required</div>
                                            <div ng-message="pattern">Invalid credit card number</div>
                                        </div>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <label for="cc-exp">MM/YY</label>
                                        <input name="ccExp" id="cc-exp" ng-model="payment.exp_date"
                                               ng-pattern="/^\d{2}\/\d{2}$/" ng-required="payment.amount > 0"
                                                expired-validator>

                                        <div ng-messages="paymentForm.ccExp.$error" role="alert">
                                            <div ng-message="required">Required</div>
                                            <div ng-message="pattern">Invalid exp date (ex: 12/15)</div>
                                            <div ng-message="expired">Date is too old</div>
                                        </div>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <label for="cc-csc">CVC</label>
                                        <input name="cvc" id="cc-csc" ng-model="payment.cvv2" ng-pattern="/^\d{3}$/"
                                               ng-required="payment.amount > 0" inputmode="numeric" size="3" maxlength="3">

                                        <div ng-messages="paymentForm.cvc.$error">
                                            <div ng-message="required">Required</div>
                                            <div ng-message="pattern">Invalid cvc (ex: 123)</div>
                                        </div>
                                    </md-input-container>
                                </div>
                            </div>
                            <div layout-align="center">
                                <md-button class="md-primary md-raised" type="submit"
                                           ng-disabled="userForm.$invalid || paymentForm.$invalid"
                                           ng-click="newMember(userForm.$valid)">Submit</md-button>
                            </div>
                        </ng-form>
                </md-tab>
        </md-tabs>
    </form>
</div>
